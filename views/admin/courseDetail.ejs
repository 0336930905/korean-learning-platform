<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chi ti·∫øt kh√≥a h·ªçc - <%= course.title %></title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .animate-fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .progress-bar {
            background: #f3f4f6;
            border-radius: 10px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #10b981, #34d399);
            border-radius: 10px;
            transition: width 0.3s ease;
        }
        
        .stat-card {
            transition: transform 0.2s ease, box-shadow 0.2s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="flex h-screen">
        <%- include('../partials/admin_sidebar', { user: user }) %>
        
        <div class="flex-1 flex flex-col overflow-hidden">
            <%- include('../partials/dashboards_header', { user: user }) %>

            <main class="flex-1 overflow-x-hidden overflow-y-auto bg-gray-50">
                <!-- Header Section -->
                <div class="gradient-bg py-8 px-8 text-white">
                    <div class="max-w-7xl mx-auto">
                        <!-- Breadcrumb -->
                        <nav class="flex mb-6" aria-label="Breadcrumb">
                            <ol class="inline-flex items-center space-x-1 md:space-x-3">
                                <li class="inline-flex items-center">
                                    <a href="/dashboard/admin" class="text-indigo-100 hover:text-white transition-colors">
                                        <i class="fas fa-home mr-2"></i>Dashboard
                                    </a>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-chevron-right text-indigo-200 mx-2"></i>
                                    <a href="/admin/course-management" class="text-indigo-100 hover:text-white transition-colors">
                                        Qu·∫£n l√Ω kh√≥a h·ªçc
                                    </a>
                                </li>
                                <li class="flex items-center">
                                    <i class="fas fa-chevron-right text-indigo-200 mx-2"></i>
                                    <span class="text-white font-medium">Chi ti·∫øt kh√≥a h·ªçc</span>
                                </li>
                            </ol>
                        </nav>
                        
                        <!-- Course Header -->
                        <div class="flex flex-col lg:flex-row lg:items-start lg:justify-between gap-6">
                            <div class="flex-1">
                                <h1 class="text-3xl font-bold mb-3">
                                    <i class="fas fa-book mr-3"></i>
                                    <%= course.title %>
                                </h1>
                                <div class="flex flex-wrap items-center gap-4 mb-4">
                                    <span class="px-3 py-1 text-sm font-semibold rounded-full 
                                                <%= course.level === 'beginner' ? 'bg-green-100 text-green-800' : 
                                                   course.level === 'intermediate' ? 'bg-blue-100 text-blue-800' : 
                                                   'bg-purple-100 text-purple-800' %>">
                                        <%= course.level === 'beginner' ? 'üü¢ S∆° c·∫•p' : 
                                           course.level === 'intermediate' ? 'üîµ Trung c·∫•p' : 'üü£ Cao c·∫•p' %>
                                    </span>
                                    <span class="px-3 py-1 text-sm bg-white/20 backdrop-blur-sm rounded-full text-white">
                                        üìö <%= course.category %>
                                    </span>
                                    <span class="px-3 py-1 text-sm bg-white/20 backdrop-blur-sm rounded-full text-white">
                                        <i class="fas fa-clock mr-1"></i><%= course.duration %>
                                    </span>
                                </div>
                                <p class="text-indigo-100 text-lg leading-relaxed">
                                    <%= course.description %>
                                </p>
                            </div>
                            
                            <!-- Course Image -->
                            <div class="lg:w-80">
                                <% if (course.imageUrl) { %>
                                    <img src="<%= course.imageUrl %>" alt="<%= course.title %>" 
                                         class="w-full h-48 object-cover rounded-xl shadow-lg border-2 border-white/30">
                                <% } else { %>
                                    <div class="w-full h-48 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center border-2 border-white/30">
                                        <i class="fas fa-book text-white text-4xl"></i>
                                    </div>
                                <% } %>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="max-w-7xl mx-auto px-8 py-8">
                    <!-- Statistics Cards -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="stat-card glass-card rounded-xl p-6 animate-fade-in">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">T·ªïng h·ªçc vi√™n</p>
                                    <p class="text-3xl font-bold text-blue-600"><%= course.enrolledCount || 0 %></p>
                                </div>
                                <div class="bg-blue-100 p-3 rounded-full">
                                    <i class="fas fa-users text-blue-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.1s">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">Gi√° kh√≥a h·ªçc</p>
                                    <p class="text-3xl font-bold text-green-600"><%= course.price.toLocaleString('vi-VN') %></p>
                                    <p class="text-xs text-gray-500">VNƒê</p>
                                </div>
                                <div class="bg-green-100 p-3 rounded-full">
                                    <i class="fas fa-money-bill-wave text-green-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.2s">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">T·ª∑ l·ªá ho√†n th√†nh</p>
                                    <p class="text-3xl font-bold text-purple-600">85%</p>
                                </div>
                                <div class="bg-purple-100 p-3 rounded-full">
                                    <i class="fas fa-chart-line text-purple-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                        
                        <div class="stat-card glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.3s">
                            <div class="flex items-center justify-between">
                                <div>
                                    <p class="text-sm font-medium text-gray-600">ƒê√°nh gi√° trung b√¨nh</p>
                                    <p class="text-3xl font-bold text-yellow-600">4.8</p>
                                    <div class="flex text-yellow-500 text-sm">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </div>
                                <div class="bg-yellow-100 p-3 rounded-full">
                                    <i class="fas fa-star text-yellow-600 text-xl"></i>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Course Details Grid -->
                    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                        <!-- Main Content -->
                        <div class="lg:col-span-2 space-y-8">
                            <!-- Course Information -->
                            <div class="glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.4s">
                                <h2 class="text-xl font-bold text-gray-900 mb-6">
                                    <i class="fas fa-info-circle text-blue-600 mr-2"></i>
                                    Th√¥ng tin kh√≥a h·ªçc
                                </h2>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">T√™n kh√≥a h·ªçc</label>
                                            <p class="text-gray-900 font-semibold"><%= course.title %></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Danh m·ª•c</label>
                                            <p class="text-gray-900"><%= course.category %></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">C·∫•p ƒë·ªô</label>
                                            <p class="text-gray-900">
                                                <%= course.level === 'beginner' ? 'S∆° c·∫•p (Beginner)' : 
                                                   course.level === 'intermediate' ? 'Trung c·∫•p (Intermediate)' : 
                                                   'Cao c·∫•p (Advanced)' %>
                                            </p>
                                        </div>
                                    </div>
                                    <div class="space-y-4">
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Gi·∫£ng vi√™n</label>
                                            <p class="text-gray-900 font-semibold">
                                                <%= course.instructor ? course.instructor.fullName : 'Ch∆∞a ph√¢n c√¥ng' %>
                                            </p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Th·ªùi l∆∞·ª£ng</label>
                                            <p class="text-gray-900"><%= course.duration %></p>
                                        </div>
                                        <div>
                                            <label class="block text-sm font-medium text-gray-700 mb-1">Tr·∫°ng th√°i</label>
                                            <span class="px-3 py-1 text-sm font-medium rounded-full bg-green-100 text-green-800">
                                                <i class="fas fa-check-circle mr-1"></i>Ho·∫°t ƒë·ªông
                                            </span>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-6">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">M√¥ t·∫£ kh√≥a h·ªçc</label>
                                    <p class="text-gray-900 leading-relaxed"><%= course.description %></p>
                                </div>
                            </div>

                            <!-- Enrolled Students -->
                            <div class="glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.5s">
                                <div class="flex items-center justify-between mb-6">
                                    <h2 class="text-xl font-bold text-gray-900">
                                        <i class="fas fa-users text-blue-600 mr-2"></i>
                                        Danh s√°ch h·ªçc vi√™n
                                    </h2>
                                    <span class="px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full">
                                        <%= course.enrolledCount || 0 %> h·ªçc vi√™n
                                    </span>
                                </div>
                                
                                <% if (course.enrolledStudents && course.enrolledStudents.length > 0) { %>
                                    <div class="space-y-3">
                                        <% course.enrolledStudents.forEach(function(student, index) { %>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div class="flex items-center">
                                                    <div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center mr-3">
                                                        <span class="text-white font-semibold text-sm">
                                                            <%= student.fullName ? student.fullName.charAt(0).toUpperCase() : 'U' %>
                                                        </span>
                                                    </div>
                                                    <div>
                                                        <p class="font-medium text-gray-900"><%= student.fullName || 'Ng∆∞·ªùi d√πng' %></p>
                                                        <p class="text-sm text-gray-500"><%= student.email %></p>
                                                    </div>
                                                </div>
                                                <div class="text-sm text-gray-500">
                                                    <i class="fas fa-calendar mr-1"></i>
                                                    ƒêƒÉng k√Ω: <%= new Date(student.enrolledAt || Date.now()).toLocaleDateString('vi-VN') %>
                                                </div>
                                            </div>
                                        <% }); %>
                                    </div>
                                <% } else { %>
                                    <div class="text-center py-8">
                                        <i class="fas fa-users text-gray-300 text-4xl mb-4"></i>
                                        <p class="text-gray-500">Ch∆∞a c√≥ h·ªçc vi√™n n√†o ƒëƒÉng k√Ω kh√≥a h·ªçc n√†y</p>
                                    </div>
                                <% } %>
                            </div>
                        </div>

                        <!-- Sidebar -->
                        <div class="space-y-8">
                            <!-- Course Progress -->
                            <div class="glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.6s">
                                <h3 class="text-lg font-bold text-gray-900 mb-4">
                                    <i class="fas fa-chart-pie text-green-600 mr-2"></i>
                                    Ti·∫øn ƒë·ªô kh√≥a h·ªçc
                                </h3>
                                
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between text-sm mb-1">
                                            <span class="text-gray-600">Ho√†n th√†nh b√†i h·ªçc</span>
                                            <span class="font-medium text-gray-900">85%</span>
                                        </div>
                                        <div class="progress-bar h-2">
                                            <div class="progress-fill" style="width: 85%"></div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between text-sm mb-1">
                                            <span class="text-gray-600">B√†i t·∫≠p ƒë√£ n·ªôp</span>
                                            <span class="font-medium text-gray-900">72%</span>
                                        </div>
                                        <div class="progress-bar h-2">
                                            <div class="progress-fill" style="width: 72%"></div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between text-sm mb-1">
                                            <span class="text-gray-600">Tham gia th·∫£o lu·∫≠n</span>
                                            <span class="font-medium text-gray-900">90%</span>
                                        </div>
                                        <div class="progress-bar h-2">
                                            <div class="progress-fill" style="width: 90%"></div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Course Stats Chart -->
                            <div class="glass-card rounded-xl p-6 animate-fade-in" style="animation-delay: 0.7s">
                                <h3 class="text-lg font-bold text-gray-900 mb-4">
                                    <i class="fas fa-chart-line text-purple-600 mr-2"></i>
                                    Th·ªëng k√™ ho·∫°t ƒë·ªông
                                </h3>
                                
                                <div style="height: 250px; position: relative;">
                                    <canvas id="activityChart"></canvas>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </main>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Initialize activity chart
        $(document).ready(function() {
            const ctx = document.getElementById('activityChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['T2', 'T3', 'T4', 'T5', 'T6', 'T7', 'CN'],
                    datasets: [{
                        label: 'S·ªë h·ªçc vi√™n ho·∫°t ƒë·ªông',
                        data: [12, 19, 15, 25, 22, 18, 8],
                        borderColor: '#8b5cf6',
                        backgroundColor: 'rgba(139, 92, 246, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                display: true,
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#6b7280'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: {
                                    size: 12
                                },
                                color: '#6b7280'
                            }
                        }
                    }
                }
            });
        });
    </script>
</body>
</html>
